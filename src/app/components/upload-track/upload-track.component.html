<div class="upload-dialog">
  <h2>Upload New Track</h2>
  
  <form [formGroup]="uploadForm">
    <!-- Main Content Grid -->
    <div class="form-grid">
      <!-- Left Column: Upload Areas -->
      <div class="upload-section">
        <!-- Audio Upload -->
        <div class="upload-area" (click)="audioFileInput.click()">
          <input type="file" 
                 #audioFileInput 
                 (change)="onAudioFileSelected($event)"
                 accept="audio/*">

          <div *ngIf="!selectedFileInfo" class="upload-placeholder">
            <mat-icon class="upload-icon">music_note</mat-icon>
            <div class="upload-label">Select Audio Track</div>
            <div class="upload-hint">MP3, WAV up to 10MB</div>
          </div>

          <div *ngIf="selectedFileInfo" class="file-preview">
            <mat-icon class="file-icon">audiotrack</mat-icon>
            <div class="file-info">
              <p class="file-name">{{ selectedFileInfo.name }}</p>
              <p class="file-size">{{ selectedFileInfo.size | fileSize }}</p>
            </div>
            <button mat-icon-button class="remove-button" (click)="removeAudioFile(); $event.stopPropagation()">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>

        <!-- Image Upload -->
        <div class="upload-area" (click)="imageFileInput.click()">
          <input type="file" 
                 #imageFileInput 
                 (change)="onImageSelected($event)"
                 accept="image/*">

          <div *ngIf="!imagePreview" class="upload-placeholder">
            <mat-icon class="upload-icon">image</mat-icon>
            <div class="upload-label">Add Cover Image</div>
            <div class="upload-hint">JPG, PNG up to 2MB</div>
          </div>

          <div *ngIf="imagePreview" class="file-preview image-preview">
            <img [src]="imagePreview" alt="Track thumbnail">
            <button mat-icon-button class="remove-button" (click)="removeImage(); $event.stopPropagation()">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
      </div>

      <!-- Right Column: Track Details -->
      <div class="details-section">
        <mat-form-field appearance="outline">
          <mat-label>Track Title</mat-label>
          <input matInput formControlName="title" placeholder="Enter track title">
          <mat-error *ngIf="uploadForm.get('title')?.errors">
            {{ getErrorMessage('title') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Artist</mat-label>
          <input matInput formControlName="artist" placeholder="Enter artist name">
          <mat-error *ngIf="uploadForm.get('artist')?.errors">
            {{ getErrorMessage('artist') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Category</mat-label>
          <mat-select formControlName="category">
            <mat-option *ngFor="let category of categories" [value]="category">
              {{ category | titlecase }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="uploadForm.get('category')?.errors">
            {{ getErrorMessage('category') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Description</mat-label>
          <textarea matInput 
                    formControlName="description" 
                    placeholder="Enter track description"
                    rows="4">
          </textarea>
          <mat-error *ngIf="uploadForm.get('description')?.errors">
            {{ getErrorMessage('description') }}
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <!-- Bottom Actions -->
    <div class="actions">
      <button mat-stroked-button (click)="dialogRef.close()">
        Cancel
      </button>
      <button mat-flat-button 
              color="primary"
              (click)="uploadTrack()"
              [disabled]="!uploadForm.valid || !selectedFile || isUploading">
        <mat-icon>cloud_upload</mat-icon>
        {{ isUploading ? 'Uploading...' : 'Upload Track' }}
      </button>
    </div>

    <!-- Progress Bar -->
    <mat-progress-bar *ngIf="isUploading"
                      mode="determinate"
                      [value]="uploadProgress"
                      class="upload-progress">
    </mat-progress-bar>
  </form>
</div>
  